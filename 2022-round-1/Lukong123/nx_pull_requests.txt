https://github.com/networkx/networkx/pull/5471
https://github.com/networkx/networkx/pulls/Lukong123
https://github.com/networkx/networkx/pull/5485
https://github.com/networkx/networkx/pull/5493
